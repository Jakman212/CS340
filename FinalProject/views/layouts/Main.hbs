{{!--
  ============================================================
    Main.hbs — Study Application Layout Template (CS340)
    Group 69 — Sasan Pourassef & Jeremy Dempsey
    Oregon State University

    Description:
    This file contains the main layout template for the
    Study Application. It provides:
        • Common HTML structure (head, body, navigation)
        • Navigation bar with links to all entity pages
        • RESET button for database restoration
        • CSS stylesheet linking

    Purpose:
    This layout wraps all other handlebars views and provides:
        1) Consistent navigation across all pages
        2) Centralized stylesheet and script inclusion
        3) Database reset functionality accessible from any page
        4) Responsive HTML5 structure
    
    Sources:
        • This file was created based on standard Handlebars
          layout practices and customized for the Study Application.

  ============================================================
--}}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Application - Group 69</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <header>
        <h1>Study Application</h1>
        <p class="subtitle">Group 69: Sasan Pourassef & Jeremy Dempsey</p>

        <nav>
            <a href="/">Home</a>
            <a href="/users">Users</a>
            <a href="/studysets">Study Sets</a>
            <a href="/flashcards">Flashcards</a>
            <a href="/quizzes">Quizzes</a>

            <!-- Reset button styled exactly like other nav links -->
            <a href="#" id="reset-link" onclick="return handleResetClick();">
                Reset Database
            </a>
        </nav>
    </header>

    <main>
        {{{body}}}
    </main>

    <footer>
        <p>CS340 Database Project - Oregon State University</p>
    </footer>

    <script src="/script.js"></script>

    <!-- Reset confirmation & success popup -->
    <script>
        function handleResetClick() {
            const ok = confirm(
                "Are you sure you want to reset the database to its sample data state? This cannot be undone."
            );
            if (!ok) return false;

            // Store the current page URL to reload after reset
            const currentPage = window.location.pathname;

            // Call the reset endpoint
            fetch('/reset-database', {
                method: 'GET',
            })
            .then(response => {
                if (response.ok) {
                    // Show success popup
                    alert("✅ Database has been reset to sample data.");
                    // Reload current page to reflect changes
                    window.location.href = currentPage;
                } else {
                    alert("❌ Error resetting database. Please try again.");
                }
            })
            .catch(error => {
                console.error('Error during reset:', error);
                alert("❌ Error resetting database. Please try again.");
            });

            return false;
        }
    </script>

</body>
</html>
